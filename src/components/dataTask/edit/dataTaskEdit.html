<div>
    <b-modal ref="edit-task-modal"
             id="edit-task-modal"
             size="lg"
             header-bg-variant="light"
             footer-bg-variant="light"
             no-close-on-esc
             no-close-on-backdrop
             width="600px"
             hide-header-close
             title="Data Task Configuration"
             v-model="showModal"
             @hidden="onModalHidden"
             @show="onShowModal">

        <b-alert :show="alertSec"
                 dismissible
                 @dismissed="alertSec=0"
                 class="text-danger"
                 variant="warning">
            {{ alertMessage }}
        </b-alert>

        <b-container class="bv-example-row" >

            <b-row class="py-1">
                <b-col cols="2" class="pt-2" style="text-align: right">Task Handler:<i class="fa fa-warning"></i></b-col>
                <b-col cols="10">
                    <b-form-select v-validate name="task_handler" :state="!errors.has('task_handler')" :disabled="!isNew" v-model="selectedHandler" :options="handlerSettingsSelectList"></b-form-select>
                    <span v-show="errors.has('task_handler')" class="pt-2 text-danger" style="display:block">{{ errors.first('task_handler') }}</span>
                </b-col>
            </b-row>
 
            <b-row class="py-1">
                <b-col cols="2" class="pt-2" style="text-align: right">Task Name:</b-col>
                <b-col cols="10">
                    <b-form-input v-validate="'required'" data-vv-as="Task Name" name="task_name" :state="!errors.has('task_name')" v-model="dataTask.DisplayName" id="task-name-input" type="text" placeholder="Enter Task Name"></b-form-input>
                    <span v-show="errors.has('task_name')" class="pt-2 text-danger" style="display:block">{{ errors.first('task_name') }}</span>
                </b-col>
            </b-row>
 
            <b-row class="py-1">
                <b-col cols="2" class="pt-2" style="text-align: right">Group Name:</b-col>
                <b-col cols="10">
                    <b-form-input v-validate="'required'" data-vv-as="Group Name" name="group_name" :state="!errors.has('group_name')" v-model="dataTask.GroupName" id="task-name-input" type="text" placeholder="Enter Group Name"></b-form-input>
                    <span v-show="errors.has('group_name')" class="pt-2 text-danger" style="display:block">{{ errors.first('group_name') }}</span>
                </b-col>
            </b-row>
        
            <b-row class="py-1 my-2">
                <b-col cols="2" class="pt-2" style="text-align: right">Max Retries:</b-col>
                <b-col cols="2" style="text-align: right">
                    <b-form-input  v-model="dataTask.MaxRetries" class="text-center" style="width:100%" type="number"></b-form-input>
                </b-col>
                <b-col cols="1">
                </b-col>
                <b-col cols="3">
                    <v-switch label="Is Enabled" v-model="dataTask.Enabled" color="info" hide-details></v-switch>
                </b-col>
                <b-col cols="4">
                    <v-switch label="Is Maintenance" v-model="dataTask.IsMaintenance" color="info" hide-details></v-switch>
                </b-col>
            </b-row>

            <b-row class="py-1">
                <b-col cols="2" class="pt-2" style="text-align: right">Scheduling:</b-col>
                <b-col cols="10">
                    <cron-presets :cronValue="dataTask.getCronSchedule().toString()" :cronPresets="cronPresets" @change="onCronPresetsChange"></cron-presets>
                </b-col>

            </b-row>

            <b-row class="py-1">
                <b-col cols="2"></b-col>
                <b-col cols="10" class="pt-2"> 
                    <edit-view-element :element="dataTask.getCronSchedule()" ></edit-view-element>
                </b-col>
            </b-row>

            <!-- cron-style-scheduling :cron="dataTask.getCronSchedule()"></cron-style-scheduling-->

            <b-row class="pb-1 pt-3">
                <b-col cols="3">
                    <h6 style="padding-top:13px !important;">Task Parameters</h6>
                </b-col>
                <b-col>
                    <v-btn flat round outline color="primary" dark :disabled="handlerSettings.isDefault()" @click.native.stop="handlerSettings.resetToDefault(); initToggle=!initToggle">
                        reset to default
                    </v-btn>
                </b-col>
            </b-row>

                <custom-params :initToggle="initToggle" :customSettings="handlerSettings" :height="height"></custom-params>

            </b-container>

        <template slot="modal-footer">

            <v-btn round v-b-tooltip.hover.topright title="Save Data Task Configuration" color="primary" dark @click.native.stop="onSaveClick">
                <v-icon class="mr-2">save</v-icon>Save
            </v-btn>
            <confirmation-dialog :dialogVisible="showSaveConfirmation" 
                dialogMessage="Do you want to SAVE Changes and Close?"
                @onOkClicked="onSaveOkClicked" 
                @onCloseDialog="showSaveConfirmation = false"> </confirmation-dialog>

            <v-btn round v-b-tooltip.hover.topright title="Discard Data Task Configuration" color="red" dark @click.native.stop="showDiscardConfirmation = true">
                <v-icon class="mr-2">close</v-icon>Discard
            </v-btn>
            <confirmation-dialog :dialogVisible="showDiscardConfirmation" 
                dialogMessage="Do you want to DISCARD Changes and Close?"
                @onOkClicked="onDiscardOkClicked" 
                @onCloseDialog="showDiscardConfirmation = false"> </confirmation-dialog>

        </template>

    </b-modal>

</div>